
<!DOCTYPE HTML>

<html>
	<head>
    <title>Ember CSI</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <link rel="stylesheet" href="/assets/css/main.css" />
    
    <meta name="generator" content="Hugo 0.45.1" />
    <link href="https://fonts.googleapis.com/css?family=Pattaya" rel="stylesheet">
<link rel="icon" type="image/svg+xml" href="/images/ember.svg">
<link rel="icon" href="/images/icon192.png">

</head>

	<body class="homepage">
		<div id="page-wrapper">

			
			<div id="header-wrapper">
				<div id="header">

                    <section id="top_page">
					
<div>
<h1><a href="/"><img src="/images/ember.svg" height=64/> EMBER</a></h1>
<h2>Unified Storage Plugin for Containers</h2>
</div>

					
<div>
<nav id="nav">
    <ul>
            <li><a href="https://twitter.com/ember_csi"><i class="fa fa-twitter"></i></a></li>
            <li><a href='https://kiwiirc.com/client/irc.freenode.net/ember-csi'><i class="fa fa-hashtag"></i></a></li>
            <li><a href='https://github.com/embercsi/ember-csi'><i class="fa fa-github"></i></a></li>
            <li><a href='http://docs.ember-csi.io'><i class="fa fa-book"></i></a></li>
    </ul>
</nav>
</div>

                    </section>

				</div>
			</div>

			
			<div id="main-wrapper">
				<div class="container">
					
					
<article class="box post">
    <a href="#" class="image featured"><img src="/images/02-getstarted.jpg" alt="" /></a>
    <header>
        <h2>KubeVirt and Ember CSI</h2>
        
        <p>August 2, 2018</p>
        
    </header>
    <p>To use the Ember-CSI plugin on Kubevirt we need to make changes to our deployment.</p>

<p>The easiest way to make the changes is to copy this kubevirt directory into a directory of the kubevirt repository, and run the <code>csi_up.sh</code> script from there after the cluster is up and running.</p>

<p>For now the example only supports single node deployments, and for convenience we are using a pod instead of a StatefulSet and DaemonSets and the permissions are too broad.</p>

<p>Given the following assumptions:</p>

<ul>
<li>This <code>kubevirt</code> directory is in <code>$cl_example</code>.</li>
<li>We have modified <code>X_CSI_BACKEND_CONFIG</code> environmental variable in the <code>csi.yml</code> (example is for XtremIO).</li>
<li>Our current working directory is <code>kubevirt</code> repository&rsquo;s root directory.</li>
<li>We haven&rsquo;t created a kubevirt cluster yet.</li>
</ul>

<p>The following commands will create the cluster, make changes to the cluster to support CSI plugins, deploy the CSI plugin, create a PVC, and an app that uses the PVC:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">make cluster-up
make cluster-sync

<span style="color:#75715e"># Modify the cluster for CSI
</span><span style="color:#75715e"></span>csi/csi_up.sh

<span style="color:#75715e"># Setup RBAC
</span><span style="color:#75715e"></span>cluster/kubectl.sh create -f csi/rbac.yml

<span style="color:#75715e"># Setup the CSI driver
</span><span style="color:#75715e"></span>cluster/kubectl.sh create -f csi/csi.yml

<span style="color:#75715e"># Create a PVC (creates a volume on the storage via the CSI plugin)
</span><span style="color:#75715e"></span>cluster/kubectl.sh create -f csi/pvc.yml

<span style="color:#75715e"># Create an APP that uses the created volume
</span><span style="color:#75715e"></span>cluster/kubectl.sh create -f csi/app.yml</code></pre></div>
<p>We can send GRPC commands to the CSI driver using the deployed csc container.</p>

<p>For example to list volumes you can do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cluster/kubectl.sh exec -c csc -it csi-xtremio-pod csc controller list-volumes</code></pre></div>
</article>



					
				</div>
			</div>

            
<div id="footer-wrapper">
    <section id="footer" class="container">
        <div class="row">
    <div class="12u">

        
            <div id="copyright">
                &copy; Ember CSI. All rights reserved. Design by geguileo based on <a href="https://curtistimson.co.uk">curttimson</a>'s Hugo port of a <a href="http://html5up.net">HTML5 UP</a> template.  Background image based one from <a href="https://torange.biz/fx/digital-binary-data-futuristic-infographic-background-172436">torange.biz</a>.
            </div>

    </div>
</div>

    </section>
</div>


        </div>

		
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/jquery.dropotron.min.js"></script>
<script src="/assets/js/skel.min.js"></script>
<script src="/assets/js/skel-viewport.min.js"></script>
<script src="/assets/js/util.js"></script>

<script src="/assets/js/main.js"></script>





	</body>
</html>
